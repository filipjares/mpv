<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0086)http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>
    courses:a4m33mpv:cviceni:2_hledani_korespondenci:start    [Course Ware]
  </title>

  <meta name="generator" content="DokuWiki Release 2009-12-25c &quot;Lemming&quot;">
<meta name="robots" content="noindex,nofollow">
<meta name="date" content="2012-02-24T12:28:25+0100">
<meta name="keywords" content="courses,a4m33mpv,cviceni,2_hledani_korespondenci,start">
<link rel="search" type="application/opensearchdescription+xml" href="http://cw.felk.cvut.cz/lib/exe/opensearch.php" title="Course Ware">
<link rel="start" href="http://cw.felk.cvut.cz/">
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="http://cw.felk.cvut.cz/feed.php">
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="http://cw.felk.cvut.cz/feed.php?mode=list&ns=courses:a4m33mpv:cviceni:2_hledani_korespondenci">
<link rel="alternate" type="text/html" title="Plain HTML" href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start?do=export_xhtml">
<link rel="alternate" type="text/plain" title="Wiki Markup" href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start?do=export_raw">
<link rel="canonical" href="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware].html">
<link rel="stylesheet" media="all" type="text/css" href="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/css.php">
<link rel="stylesheet" media="screen" type="text/css" href="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/css(1).php">
<link rel="stylesheet" media="print" type="text/css" href="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/css(2).php">
<script type="text/javascript" charset="utf-8"><!--//--><![CDATA[//><!--
var NS='courses:a4m33mpv:cviceni:2_hledani_korespondenci';var JSINFO = {"id":"courses:a4m33mpv:cviceni:2_hledani_korespondenci:start","namespace":"courses:a4m33mpv:cviceni:2_hledani_korespondenci"};
//--><!]]></script>
<script type="text/javascript" charset="utf-8" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/js.php"></script><style type="text/css" media="screen"><!--/*--><![CDATA[/*><!--*/ .folded.hidden { display: none; } .folder .indicator { visibility: visible; } /*]]>*/--></style>
<script type="text/javascript" charset="utf-8" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/menu.js"></script>
<script type="text/javascript" charset="utf-8" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/indexmenu.js"></script>
<script type="text/javascript" charset="utf-8"><!--//--><![CDATA[//><!--
var indexmenu_ID='courses/a4m33mpv/cviceni/2_hledani_korespondenci/start'
//--><!]]></script>

  <link rel="shortcut icon" href="http://cw.felk.cvut.cz/lib/tpl/cmp/images/favicon.ico">

  </head>

<body class="sidebar_outside_left">


<div class="dokuwiki">
  
  <div class="stylehead">

    <div class="header">
      <div class="pagename">
        [[<a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start?do=backlink" title="Backlinks">courses:a4m33mpv:cviceni:2_hledani_korespondenci:start</a>]]
      </div>
      <div class="logo">
        <a href="http://cw.felk.cvut.cz/doku.php" name="dokuwiki__top" id="dokuwiki__top" accesskey="h" title="[H]">Course Ware</a>      </div>

      <div class="clearer"></div>
    </div>

    
    <div class="bar" id="bar__top">
      <div class="bar-left" id="bar__topleft">

  
   <!-- BEGIN tpl_sidebar_showhide -->
   <form class="button" method="post" action="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware].html">
       <input type="hidden" name="side_show" value="false">
     <input type="submit" value="Hide Sidebar" class="button">
   </form>
   <!-- END tpl_sidebar_showhide -->


	      </div>

      <div class="bar-right" id="bar__topright">
                <form action="http://cw.felk.cvut.cz/doku.php" accept-charset="utf-8" class="search" id="dw__search"><div class="no"><input type="hidden" name="do" value="search"><input type="text" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]"><input type="submit" value="Search" class="button" title="Search"><div id="qsearch__out" class="ajax_qsearch JSpopup" style="display: none; "></div></div></form>&nbsp;
      </div>

      <div class="clearer"></div>
    </div>

    
    
  </div>
  
  
  <div class="page">
    <!-- wikipage start -->
    <!-- TOC START -->
<div class="toc">
<div class="tocheader toctoggle" id="toc__header" style="cursor: pointer; "><span id="toc__toggle" style="cursor: pointer; " class="toc_close"><span>−</span></span>Table of Contents</div>
<div id="toc__inside">

<ul class="toc">
<li class="level1"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#hledani_korespondenci" class="toc">Hledání korespondencí</a></span></div></li>
<li class="level1"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#detekce_bodu_zajmu" class="toc">1. Detekce bodů zájmu</a></span></div>
<ul class="toc">
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#hessian_detektor" class="toc">Hessian detektor</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#harrisuv_detektor" class="toc">Harrisův detektor</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#scale-space_-_prostor_meritek_a_automaticke_urceni_meritka" class="toc">Scale-space - prostor měřítek a automatické určení měřítka</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#afinni_kovariance_baumbergova_iterace" class="toc">Afinní kovariance, Baumbergova iterace</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#maximalne_stabilni_extremalni_oblasti" class="toc">Maximalně Stabilní Extremální Oblasti</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#datova_sada" class="toc">Dátová sada</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#co_odevzdat" class="toc">Co odevzdat?</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#kontrola_vysledku" class="toc">Kontrola výsledků</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#reference" class="toc">Reference</a></span></div></li>
</ul>
</li>
<li class="level1"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#generovani_lokalniho_invariantniho_popisu" class="toc">2. Generování lokálního invariantního popisu</a></span></div>
<ul class="toc">
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#geometricka_normalizace" class="toc">Geometrická normalizace</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#fotometricka_normalizace" class="toc">Fotometrická normalizace</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#vypocet_popisu" class="toc">Výpočet popisu</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#sift_popis_-_lokalni_histogram_orientaci_volitelny_ukol" class="toc">SIFT popis - Lokální histogram orientací (volitelný úkol)</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#co_odevzdat1" class="toc">Co odevzdat</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#kontrola_vysledku1" class="toc">Kontrola výsledků</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#reference1" class="toc">Reference</a></span></div></li>
</ul>
</li>
<li class="level1"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#hledani_tentativnich_korespondenci_a_ransac" class="toc">3. Hledání tentativních korespondencí a RANSAC</a></span></div>
<ul class="toc">
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#priprava" class="toc">Příprava</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#tentativni_korespondence" class="toc">Tentativní korespondence</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#ransac_a_geometricky_model_sceny" class="toc">RANSAC a geometrický model scény</a></span></div>
<ul class="toc">
<li class="level3"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#nalezeni_transformace_rovinne_sceny" class="toc">Nalezení transformace rovinné scény</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#ransac" class="toc">RANSAC</a></span></div></li>
</ul>
</li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#vzajemna_poloha_dvou_kamer_epipolarni_geometrie" class="toc">Vzájemná poloha dvou kamer, epipolární geometrie</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#zadani_ulohy_na_hledani_korespondenci" class="toc">Zadání úlohy na hledání korespondencí</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#kontrola_vysledku2" class="toc">Kontrola výsledků</a></span></div></li></ul>
</li></ul>
</div>
</div>
<!-- TOC END -->



<h1><a name="hledani_korespondenci" id="hledani_korespondenci">Hledání korespondencí</a></h1>
<div class="level1">

<p>

Hledání korespondencí je jedným ze základních problémů počítačového vidění. Cílem je najít odpovídajíci si části scény ve dvou nebo více obrazcích. Hledání korespondence pro každý pixel je výpočetně náročné. Metoda založená na korespondencích lokálních příznaků proto v každém obrazu nejdřív nalezne tzv. detektorem množina 'záchytných' bodů resp. regionů, ze kterých budou vybrány korespondující (lícovací) páry. Je třeba najít v různých obrazech takové odpovídající si body, které lze opakovaně identifikovat nehledě na geometrické a fotometrické transformace obrazu.
K pozici každého záchytného bodu se přiřadí zakódovaný popis jeho okolních pixelů. Může to být např. vektor jasů okolních pixelů, histogram jasů, histogram gradientů nebo jiný invariantní popis. Způsob zakódování ovlivňuje dvě věci: invarianci vůči transformacím a diskriminativitu popisu. Výslední popis je takzvaný lokální příznak, vektor zachycujíci charakteristiky obrazové funkce malého, dobře lokalizovaného okolí záchytného bodu.
Pri vlastním hledání korespondencí metodou lokálních příznaků se každý záchytný bod z prvního obrazu nalezneme bod z druhého obrazu s nejbližším popisem. Vlivem šumu, zákrytů a nepřesností modelů geometrické a fotometrické transformace jsou některé nalezené korespondence špatné, t.j. nespojují tytéž body scény. Potřebujeme tedy robustní algoritmus, jenž na základe známeho modelu transformace scény vybere největší podmnožinu korespondencí, v níž se všechny korespondence transformují konzistentne s modelem. Jedním z takových algoritmů je RANSAC (RANdom SAmpling Concensus), který si představíme v závěrečné časti úlohy.
</p>

</div>

<h1><a name="detekce_bodu_zajmu" id="detekce_bodu_zajmu">1. Detekce bodů zájmu</a></h1>
<div class="level1">

<p>

První krok hledání korespondencí je nalezení tzv. záchytných bodů resp. oblastí (interest regions). Vyzkoušíme si napsat dva často používané detektory záchytních bodů, detektor maxim Hessiánu a Harrisův detektor.
</p>

</div>

<h2><a name="hessian_detektor" id="hessian_detektor">Hessian detektor</a></h2>
<div class="level2">

<p>

Úkolem detektoru je opakovaně najít v obraze body nebo oblasti, jež jsou dobře lokalizovány a v jejichž okolí je dostatek informace aby bylo možné najít pokud možno jednoznačný popis jeho okolí. Detektor lokálních extrémů Hessiánu – determinantu <a href="http://cs.wikipedia.org/wiki/Hessova_matice" class="urlextern" title="http://cs.wikipedia.org/wiki/Hessova_matice" rel="nofollow">Hessovy</a> matice (matice druhých derivací)
</p>

<p>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch.php" class="latex" title="Graph" alt="Graph">
</p>

<p>
hledá centra tzv. blobů, lokálních extrémů intenzitní funkce, které jsou dobře lokalizovány v okolí daném variancí <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(1).php" class="latex" title="Graph" alt="Graph">. Body zájmu jsou pak ty lokální maxima, jejichž hodnota je nad určitou hranicí  danou úrovní šumu v obrázku

</p>
<ul>
<li class="level1"><div class="li">
 Napište funkci <code>response=hessian_response(img,sigma)</code>, která vypočíta Hessián pre každý pixel vstupného obrazu <em>img</em> dle vzorce: <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(2).php" class="latex" title="Graph" alt="Graph">. Pro výpočet druhých derivací <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(3).php" class="latex" title="Graph" alt="Graph"> použijte derivaci Gaussiánu s variancí <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(4).php" class="latex" title="Graph" alt="Graph">.
</div></li>
</ul>


<p>
Pro nalezení extrémů Hessiánu budeme potřebovat funkci, která zjistí zda je bod lokální extrém, toto zjistíme srovnáním hodnoty bodu s jeho osmi okolím. 
</p>
<ul>
<li class="level1"><div class="li">
 Napište funkci <code>maximg=nonmaxsup2d(response,thresh)</code> pro potlačení nemaximálních bodů, t.j. ze vstupního obrázku <em>response</em> (matice o rozměru HxW kde H je výška a W je šířka obrázku). Funkce vrátí matici <em>maximg</em> o stejné velikosti, ve které nastaví všechny lokální maxima matice větší než <em>thresh</em> na hodnotu jedna a ostatní body v matici <em>maximg</em> nastaví na nulu. Funkce testuje lokální maxima v 8mi okolí.
</div></li>
<li class="level1"><div class="li">
 Nakonec spojte obě funkce do detektoru <code>[x,y]=hessian(img,sigma,thresh)</code>, jenž nalezne maxima Hessiánu v obrázku <em>img</em> při měrítku gradientu <em>sigma</em>. Vraťte pouze souřadnice (<em>x</em>,<em>y</em>) těch lokálnich maxim jejichž hodnota je vyšší než práh <em>thresh</em>. Pro nalezení souřadnic bodů můžete použít funkci <code>[y,x]=find(maximg)</code>. Výslední vektory <em>x</em> a <em>y</em> vraťte jako řádkové vektory stejné velikosti kde x(1),y(1) bodou souřadnice prvního bodu, x(2),y(2) druhého bodu, atd… . Dejte pozor na indexy, jenž jsou v MATLABe číslovány od jedničky a náš levý horní pixel obrázku chceme se souřadnicemi (0,0).
</div></li>
</ul>


</div>

<h2><a name="harrisuv_detektor" id="harrisuv_detektor">Harrisův detektor</a></h2>
<div class="level2">

<p>

Harrisův detektor hledá body v nichž se gradient mění v dvou ortogonálních směrech, proto se někdy označuje jak detektor rohových bodů (corner points). Využíva vlastností tzv. autokorelační matice gradientu.
</p>

<p>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(5).php" class="latex" title="Graph" alt="Graph">
</p>

<p>
kde * je operátor konvoluce. Prostřednictvím okenní funkce <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(6).php" class="latex" title="Graph" alt="Graph"> se akumulují matice vnějších součinů gradientu v <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(7).php" class="latex" title="Graph" alt="Graph"> okolí bodu. Matice vnějšího součin vektoru má vlastní vektor ve směru vektoru a vlastní číslo odpovídajíci druhé mocnině jeho velikosti. Akumulací vnějších součinů pomocí konvoluce a nalezením vlastních čísel autokorelační matice tedy můžeme určit dva dominantní směry gradientu v okolí bodu a jejich velikosti. Tohto pozorování si všimli <a href="http://en.wikipedia.org/wiki/Corner_detection#The_Harris_.26_Stephens_.2F_Plessey_corner_detection_algorithm" class="urlextern" title="http://en.wikipedia.org/wiki/Corner_detection#The_Harris_.26_Stephens_.2F_Plessey_corner_detection_algorithm" rel="nofollow">Harris a Stephens</a> a navrhli elegatní funkci 
</p>

<p>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(8).php" class="latex" title="Graph" alt="Graph">
</p>

<p>
Ta obchází výpočet vlastních čísel <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(9).php" class="latex" title="Graph" alt="Graph"> matice <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(10).php" class="latex" title="Graph" alt="Graph"> využitím ekvivalencí<br>

<br>

</p>

<p>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(11).php" class="latex" title="Graph" alt="Graph">
</p>

<p>
na zjištění vlastností jejich poměru. 
</p>

<p>
<a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/harris_response.png?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:harris_response.png"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/harris_response.png" class="mediacenter" title="Obr&aacute;zek ukazuje průběh funkce R(x,y) pro alpha=0.04, b&iacute;l&eacute; usečky označuj&iacute; izokontury s hodnotami 0, 0.02, 0.04, 0.06, ..., 0.18." alt="Obr&aacute;zek ukazuje průběh funkce R(x,y) pro alpha=0.04, b&iacute;l&eacute; usečky označuj&iacute; izokontury s hodnotami 0, 0.02, 0.04, 0.06, ..., 0.18."></a>
</p>

<p>
Obrázek ukazuje průběh funkce <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(12).php" class="latex" title="Graph" alt="Graph"> pro <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(13).php" class="latex" title="Graph" alt="Graph">, bílé usečky označují izokontury s hodnotami 0, 0.02, 0.04, 0.06, …, 0.18. Když tedy uvažujeme hodnoty vyšší než práh, požadujeme aby nižší z obou vlastních čísel (velikost menšího z dvou nejčetnejších gradientů) bylo dostatečně vysoké, a zároveň čím je nižší menší vlastní číslo  tím je vyžadována vyšší hodnota vyššího vlastního čísla. V případe, že jsou jejich hodnoty podobné mohou mít obě vlastní čísla nižší hodnotu.

</p>
<ul>
<li class="level1"><div class="li">
 Napište funkci <code>response=harris_response(img,</code><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(14).php" class="latex" title="Graph" alt="Graph"><code>,</code><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(7).php" class="latex" title="Graph" alt="Graph"><code>)</code>, která vypočíta odezvu Harrisovy funkce pro každý pixel vstupného obrazu <em>img</em>.Pro výpočet použijte derivací Gaussiánu <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(15).php" class="latex" title="Graph" alt="Graph"> se směrodatnou odchylkou <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(14).php" class="latex" title="Graph" alt="Graph"> a Gaussián jako okenní funkci se směrodatnou odchylkou <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(7).php" class="latex" title="Graph" alt="Graph"> .
</div></li>
<li class="level1"><div class="li">
 Analogicky s detektorem maxim Hessianů napište funkci <code>[x,y]=harris(img,</code><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(14).php" class="latex" title="Graph" alt="Graph"><code>,</code><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(7).php" class="latex" title="Graph" alt="Graph"><code>,thresh)</code>, detekujíci maxima Harrisovy funkce se směrodatnou odchylkou pro počítaní derivací <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(16).php" class="latex" title="Graph" alt="Graph"> a okenní funkcí se směrodatnou odchylkou <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(17).php" class="latex" title="Graph" alt="Graph"> jenž jsou vyšší než <em>thresh</em>.
</div></li>
</ul>


</div>

<h2><a name="scale-space_-_prostor_meritek_a_automaticke_urceni_meritka" id="scale-space_-_prostor_meritek_a_automaticke_urceni_meritka">Scale-space - prostor měřítek a automatické určení měřítka</a></h2>
<div class="level2">

<p>
Základní verze Harris a Hessián detektoru potřebují parametr, měrítko (rozptyl) na němž se pozorují gradienty v obraze a hledají se “bloby”. Ukázalo se, že blobům v obraze je možné toto měŕítko určit automaticky. Na jeho nalezení je potřebné vybudovat tzv. prostor měrítek, tří dimenzionální prostor, v němž dvě dimenze tvoří obrázek (x,y souřadnice) a třetí rozměr měrítko. Varianty obrazu se zvyšujícim se měrítkem získame za pomocí filtrování obrazu, potlačením detailů se simuluje situace když by sme se na scénu dívali z větší vzdálenosti. 
Se zvyšujícím se potlačením detailů se ale snižuje rozptyl intenzit, pro výběr charakteristického měrítka je potřebné aby gradienty mezi dvěma měřítky byli porovnatelné. Zavedl se proto pojem normalizované derivace vzhledem ke “vzdálenosti” mezi pixely (získáme “bezrozměrný” gradient):
</p>

<p>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(18).php" class="latex" title="Graph" alt="Graph">
</p>

<p>
Lindeberg ve své práci ukázal, že na takto normalizovaných derivacích je možné spočítat odezvu differenciálních operátorů Laplaciánu <br>

<br>

<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(19).php" class="latex" title="Graph" alt="Graph">
<br>

<br>
a Hessiánu <br>

<br>

<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(20).php" class="latex" title="Graph" alt="Graph">
<br>

<br>
a použít je na automatické určení charakteristického měrítka ideálního blobu. Vyhledáním lokálních maxim hodnot těchto operátorů v <em>x</em>,<em>y</em> a <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(21).php" class="latex" title="Graph" alt="Graph"> dostaneme pozici “blobů” spolu s jejich měřítkem.
</p>

<p>
Obrázek Gaussiánů se směrodatnými odchylkami=8,16,24 a 32. Odezva <font color="red">det(<b>H</b><sub><i>norm</i></sub>)</font> a <font color="blue">trace(<b>H</b><sub><i>norm</i></sub>)</font> v středech Gaussiánů, všimněte si posun extrému proporcionální k velikosti blobu.
</p>

<p>
<a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/blobs.png?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:blobs.png"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/blobs.png" class="media" title="Obr&aacute;zek Gaussi&aacute;nů se směrodatn&yacute;mi odchylkami=8,16,24 a 32." alt="Obr&aacute;zek Gaussi&aacute;nů se směrodatn&yacute;mi odchylkami=8,16,24 a 32." width="350" height="350"></a> <a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/scalespace_signature.png?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:scalespace_signature.png"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/scalespace_signature.png" class="media" title="Odezva differenci&aacute;ln&iacute;ch oper&aacute;torů v prostoru měř&iacute;tek ve středech Gaussi&aacute;nů." alt="Odezva differenci&aacute;ln&iacute;ch oper&aacute;torů v prostoru měř&iacute;tek ve středech Gaussi&aacute;nů." width="350" height="350"></a>

</p>
<ul>
<li class="level1"><div class="li">
 napište funkci <code>[ss,sigma]=scalespace(img,levels,step)</code>, která vrátí třírozměrný prostor meřítek (matici HxWxL, kde H je výška, W je šírka a L je počet úrovní <em>levels</em>), kde <code>ss(:,:,1)</code> bude vstupní obrázek <em>img</em> o němž budeme předpokládat <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(22).php" class="latex" title="Graph" alt="Graph"> a <code>ss(:,:,i)</code> bude jeho filtrovaná verze <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(23).php" class="latex" title="Graph" alt="Graph">, kde <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(24).php" class="latex" title="Graph" alt="Graph"> pro <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(25).php" class="latex" title="Graph" alt="Graph">. Ve vektoru <em>sigma</em> bodou hodnoty <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(26).php" class="latex" title="Graph" alt="Graph">.
</div></li>
<li class="level1"><div class="li">
 napište funkci <code>maximg=nonmaxsup3d(response, threshold)</code> pro potlačení nemaximálních bodů v třírozměrné matici <em>response</em> (t.j. uvažujte všechny 26 okolí bodu), funkce vrátí matici o velikosti jako vstupní matice <em>response</em>, ve které budou jedničky na místech lokálních maxim matice <em>response</em> větších než <em>thresh</em>.
</div></li>
</ul>


<p>

<a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/maximum26.png?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:maximum26.png"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/maximum26.png" class="media" title="Okol&iacute; bodu v 3D." alt="Okol&iacute; bodu v 3D."></a>
</p>
<ul>
<li class="level1"><div class="li">
 napište funkci <code>[hes,sigma]=sshessian_response(img)</code>, která použije funkci <code>scalespace</code> a spočítá odezvu Hessianu na normalizovaných derivacích Gaussiánu. Vhodně zvolte parametry <em>step</em> a <em>levels</em> funkce <code>scalespace</code> (napr. step=1.1, levels=40). Pro výpočet odezvy použijte odhad druhých derivací differenciálnimi filtry aplikovanými na výsledek funkce scalespace. Derivace normalizujte směrodatnou odchylkou za každý řád derivace (viď. popis výše). Výstupem bude třírozměrná matice <em>hes</em> v níž elementy budou odpovídat normalizované odezvě Hessiánu v prostoru měrítek.
</div></li>
<li class="level1"><div class="li">
 spojte funkce <code>nonmaxsup3d</code> a <code>sshessian_response</code> v detektor maxim Hessiánu s automatickým výběrem měrítka <code>[x,y,s]=sshessian(img, thresh)</code>. Vraťte jenom body jenž mají hodnotu Hessiánu vyšší než <em>thresh</em>. Výsledkem volání budou řádkové vektory stejné délky, pozice <em>x</em>, <em>y</em> a měřítko <em>s</em> maxim Hessiánu v prostoru měrítek větších než <em>thresh</em>. Levý horní bod obrázku má souřadnice 0,0. Pro lokalizaci bodů můžete použít následující program:
</div></li>
</ul>

<pre class="matlab code matlab" style="font-family:monospace;"><span class="co1">% ziskej matici maxim</span>
maximg=nonmaxsup3d<span class="br0">(</span>response, thresh<span class="br0">)</span>;
<span class="co1">% najdi pozice</span>
<span class="br0">[</span>y x u<span class="br0">]</span>=<a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/ind2sub.html"><span class="kw2">ind2sub</span></a><span class="br0">(</span><a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/size.html"><span class="kw2">size</span></a><span class="br0">(</span>nms<span class="br0">)</span>, <a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/find.html"><span class="kw2">find</span></a><span class="br0">(</span>nms<span class="br0">)</span><span class="br0">)</span>;
<span class="co1">% preved z MATLAB indexu do souradnic</span>
x=x-<span class="nu0">1</span>; y=y-<span class="nu0">1</span>;
<span class="co1">% preved u na meritko s</span>
<span class="sy0">...</span></pre>
<p>
Funkce vyzkoušejte napr. na obrázku 
</p>

<p>
<a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/sunflowers.png?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:sunflowers.png"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/sunflowers.png" class="mediacenter" alt=""></a>
</p>

<p>
pro vizualizaci nalezených bodů můžete použít funkci <a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/showpts.m" class="media mediafile mf_m" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:showpts.m">showpts.m</a>:

</p>
<pre class="matlab code matlab" style="font-family:monospace;"><span class="co1">% nacti obrazek</span>
img=<a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/imread.html"><span class="kw2">imread</span></a><span class="br0">(</span><span class="co2">'sunflowers.png'</span><span class="br0">)</span>;
<span class="co1">% najdi maxima Hessianu v scale space, pouzij threshold 0.02</span>
<span class="br0">[</span>x,y,s<span class="br0">]</span>=sshessian<span class="br0">(</span>im2double<span class="br0">(</span>rgb2gray<span class="br0">(</span>img<span class="br0">)</span><span class="br0">)</span>, 0.02<span class="br0">)</span>;
<span class="co1">% zobraz vysledek</span>
imshow<span class="br0">(</span>img<span class="br0">)</span>;
p.<span class="me1">linewidth</span>=<span class="nu0">2</span>; p.<span class="me1">color</span>=<span class="co2">'red'</span>;
showpts<span class="br0">(</span><span class="br0">[</span>x;y;s<span class="br0">]</span>, p<span class="br0">)</span>;</pre>
<p>
Měli by jste dostat podobný výstup:
</p>

<p>
<a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/sunflowers_sshesian.png?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:sunflowers_sshesian.png"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/sunflowers_sshesian.png" class="mediacenter" title="Obr&aacute;zek s detekovan&yacute;mi multiscale Hessi&aacute;n body." alt="Obr&aacute;zek s detekovan&yacute;mi multiscale Hessi&aacute;n body."></a>
</p>

</div>

<h2><a name="afinni_kovariance_baumbergova_iterace" id="afinni_kovariance_baumbergova_iterace">Afinní kovariance, Baumbergova iterace</a></h2>
<div class="level2">

<p>
<strong>(velitelný studíjní materiál, pro aktívní studenty)</strong>
</p>

<p>
Rozšíření similaritně kovariatních bodů – detekovaných maxim Hessiánu v prostoru měřítek můžeme rozšířit na affině kovariantní body až na neznámou rotaci. Základom je tzv. Baumbergova iterace, jejíž ideou je sledovat distribuci gradientů v okolí detekovaného bodu. Předpokládáme-li, že existuje transformace, která “narovná” ve výřezu okolí bodu intenzity tak, aby rozložení gradientů bylo tzv. izotropní (s gradienty rovnoměrně distribuované do všech směrů), je možné ji najít pomocí matice druhých momentů gradientu, nebo-li nám už známé autokorelační matice gradientů.
</p>

<p>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(5).php" class="latex" title="Graph" alt="Graph">
</p>

<p>
Jak sme si již řekli dřív, tato matice reflektuje lokální distribuci gradientů, dá se ukázat, že když najdeme transformaci  <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(27).php" class="latex" title="Graph" alt="Graph">, která promítne souřadný systém daný vlastními vektory a vlastními čísly matice <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(10).php" class="latex" title="Graph" alt="Graph"> na kanonický, distribuce gradientů ve výřezu transformovaném matici <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(28).php" class="latex" title="Graph" alt="Graph"> bude více izotropní. Protože jsme ovšem použili kruhovou okenní funkci, stane se, že některé gradienty v okolí započítáme se špatnou vahou, případně vůbec. Proto je nutné tento postup opakovat kým vlastní čísla matice <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(29).php" class="latex" title="Graph" alt="Graph"> z i-té iterace okolí bodu nebude blízká identitě (násobku identity). To zjistíme porovnáním poměru vlastních čísel matice <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(29).php" class="latex" title="Graph" alt="Graph">. Výslednou matici lokální afinní deformace získame jako celkovou deformaci okolí potřebnou na jeho “narovnání” na izotropní:
</p>

<p>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(30).php" class="latex" title="Graph" alt="Graph">
</p>

<p>
Tato transformace je (po přidání translace a měrítka) ze souřadnic obrázku do kanonického souřadného systému. V praxi nás většinou zajímá inverzní transformace <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(31).php" class="latex" title="Graph" alt="Graph">.

</p>
<ul>
<li class="level1"><div class="li">
 napište funkci [x,y,a11,a12,a21,a22]=affinehessian(img, threshold), která rozšíří detektor maxim Hessiánů z předchozího kroku a pro každé maximum v prostoru měřítek spočte jeden krok Baumbergovy iterace. Funkce vrátí pozici bodu a 2×2 submatici matice A: <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(32).php" class="latex" title="Graph" alt="Graph">
</div></li>
</ul>


</div>

<h2><a name="maximalne_stabilni_extremalni_oblasti" id="maximalne_stabilni_extremalni_oblasti">Maximalně Stabilní Extremální Oblasti</a></h2>
<div class="level2">

<p>

Na trochu jiném principu je založen detektor Maximalně Stabilních Extremálních Oblastí (MSER). Pri detekci se sleduje nárůstu oblastí v prahovaném obraze při zvyšování prahu intenzity. Se stupajíci intenzitou se vkládají do obrazu pixely, spojují se do oblastí až pri maximální intenzitě zůstane jediná oblast. Počas růstu se sledují statistiky jednotlivých oblastí (plocha a délka hranice) a hledají se rozsahy intenzity, kde se poměr velikosti oblasti ku délce hranice mění nejméně. MSER detektor je implementován jako <a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/extrema.zip" class="media mediafile mf_zip" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:extrema.zip">MEX modul</a>. Použití je následující:

</p>
<pre class="matlab code matlab" style="font-family:monospace;">  p.<span class="me1">min_margin</span> = <span class="nu0">10</span>;
  p.<span class="me1">min_size</span>   = <span class="nu0">30</span>;
  mser = extrema<span class="br0">(</span>img, p, <span class="br0">[</span>1 2<span class="br0">]</span><span class="br0">)</span>;</pre>
<p>

MSER jsou afinně kovariatní oblasti, jejich kovarianční matice je možné vizualizovat jako elliptické oblasti, s delší poloosí odpovídající maximálnímu rozptylu elementů. Pro konverzi na eliptické oblasti můžete použít následující kód

</p>
<pre class="matlab code matlab" style="font-family:monospace;">  regs=<span class="br0">[</span>mser<span class="br0">{</span>1<span class="br0">}</span><span class="br0">{</span>2,:<span class="br0">}</span> mser<span class="br0">{</span>2<span class="br0">}</span><span class="br0">{</span>2,:<span class="br0">}</span><span class="br0">]</span>;
  x=<span class="br0">[</span>regs.<span class="me1">cx</span><span class="br0">]</span>; y=<span class="br0">[</span>regs.<span class="me1">cy</span><span class="br0">]</span>;
  a11=<a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/sqrt.html"><span class="kw2">sqrt</span></a><span class="br0">(</span><span class="br0">[</span>regs.<span class="me1">sxx</span><span class="br0">]</span><span class="br0">)</span>; a12=<a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/zeros.html"><span class="kw2">zeros</span></a><span class="br0">(</span><a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/size.html"><span class="kw2">size</span></a><span class="br0">(</span>a11<span class="br0">)</span><span class="br0">)</span>;
  a21=<span class="br0">[</span>regs.<span class="me1">sxy</span><span class="br0">]</span>./a11;  a22=<a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/sqrt.html"><span class="kw2">sqrt</span></a><span class="br0">(</span><span class="br0">[</span>regs.<span class="me1">syy</span><span class="br0">]</span> - a21.*a21<span class="br0">)</span>;
  imshow<span class="br0">(</span>img<span class="br0">)</span>; showpts<span class="br0">(</span><span class="br0">[</span>x;y;a11;a12;a21;a22<span class="br0">]</span><span class="br0">)</span>;</pre>
<p>

Pro vizualizaci si nezapomeňte stáhnout nejnovější verzi <a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/showpts.m" class="media mediafile mf_m" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:showpts.m">showpts.m</a>.
</p>

</div>

<h2><a name="datova_sada" id="datova_sada">Dátová sada</a></h2>
<div class="level2">

<p>
Aby jste měli vaše detektory na čem zkoušet, každý nafoťte tři objekty z pěti různých pohledů se stupňující se složitostí. Dva obrázky věnujte jednoduché rotaci bez a se změnou měřítka. Ostatní odfoťte z jiných úhlů pohledu. Obrázky v rozlišení s delší hranou obrázku 1024px pomenujte obj(0-2)_view(0-4), zabalte do .zip archivu a odevzdejte do odevzdávacího systému do úlohy (02_data). Skuste na některých párech pustit napsané detektory, v případě potřeby si obrázky zmenšete na poloviční.
</p>

</div>

<h2><a name="co_odevzdat" id="co_odevzdat">Co odevzdat?</a></h2>
<div class="level2">

<p>
Očekávame, že odevzdáte funkce hessian_response.m, hessian.m, harris_response.m, harris.m, nonmaxsup2d.m, scalespace.m, nonmaxsup3d.m, sshessian_response.m a sshessian.m spolu se všemi potřebnými funkcemi. Nezapomeňte na dátovou sadu.
</p>

</div>

<h2><a name="kontrola_vysledku" id="kontrola_vysledku">Kontrola výsledků</a></h2>
<div class="level2">

<p>
Pro kontrolu výsledků vašich funkcií jsme použili skript a funkci MATLABu publish. Nakopírujte <a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/detect_test.zip" class="media mediafile mf_zip" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:detect_test.zip">detect_test.zip</a>, rozbalte ho do cesty MATLABu (nebo adresáře s vašimi funkcemi) a spusťte. <a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/results.zip" class="media mediafile mf_zip" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:results.zip">Výsledky</a> si ověrte porovnáním s <a href="http://cmp.felk.cvut.cz/~perdom1/mpv/02_detect/test.html" class="urlextern" title="http://cmp.felk.cvut.cz/~perdom1/mpv/02_detect/test.html" rel="nofollow">referenčním řešením</a>.
</p>

</div>

<h2><a name="reference" id="reference">Reference</a></h2>
<div class="level2">
<ol>
<li class="level1"><div class="li">
 <a href="http://en.wikipedia.org/wiki/Feature_detection_(computer_vision)" class="urlextern" title="http://en.wikipedia.org/wiki/Feature_detection_(computer_vision)" rel="nofollow">Přehled nejpoužívanějších metod pro hledání bodů a oblastí zájmu.</a>
</div></li>
<li class="level1"><div class="li">
 <a href="http://www.bmia.bmt.tue.nl/education/courses/FEV/book/pdf/02%20Foundations%20of%20scale-space.pdf" class="urlextern" title="http://www.bmia.bmt.tue.nl/education/courses/FEV/book/pdf/02%20Foundations%20of%20scale-space.pdf" rel="nofollow">Teoretické základy a odvození Gaussiánu jako vhodného jádra pro vybudování scale-space.</a>
</div></li>
<li class="level1"><div class="li">
 <a href="http://en.wikipedia.org/wiki/Scale-space" class="urlextern" title="http://en.wikipedia.org/wiki/Scale-space" rel="nofollow">Scale space, základní nástroj pro hledání bodů zájmu nezávislých na měřítku.</a>
</div></li>
<li class="level1"><div class="li">
 <a href="http://en.wikipedia.org/wiki/Affine_shape_adaptation" class="urlextern" title="http://en.wikipedia.org/wiki/Affine_shape_adaptation" rel="nofollow">Process afinní adaptace.</a>
</div></li>
<li class="level1"><div class="li">
 <a href="http://www.robots.ox.ac.uk/~vgg/research/affine/" class="urlextern" title="http://www.robots.ox.ac.uk/~vgg/research/affine/" rel="nofollow">Přehled afinně kovariatních detektorů</a>
</div></li>
</ol>


</div>

<h1><a name="generovani_lokalniho_invariantniho_popisu" id="generovani_lokalniho_invariantniho_popisu">2. Generování lokálního invariantního popisu</a></h1>
<div class="level1">

<p>
Pro získaní lokálního popisu invariantního k geometrickým a fotometrickým transformacím scény, potřebujeme okolí získaných záchytných bodů znormalizovat tak aby jsme odstranili efekt geometrické resp. fotometrické transformace intenzity. Po odstranění těchto deformací pak můžeme na normalizovaném okolí počítat popis, jenž je nezávislý na těchto deformacích.
</p>

<p>
Jak sme již viděli, úkolem detektoru je opakovatelně zjistit tvar okolí záchytných bodů, tak aby nalezené záchytné body byly kovariatní (měnící se stejně) s jistou tŕídou transformací scény a osvětlení. Např. základní verze Harris a Hessian detektoru hledá body které jsou translačně kovariatní (když posuneme obrázek, posunou se stejně). Hessian v prostoru měřítek nebo DoG detektor přidáva informaci o “velikosti” oblasti a tudíž body jsou similaritně kovariatní až na neznámou orientaci (detekované body jí nemají definovanou). Afinně kovariatní detektory ako MSER, Hessian-Affine alebo Harris-Affine pri využití informace o orientaci najdou oblasti jenž se mění spolu s afinní transformaci obrazu. V následující části si ukážeme jak “uchopit” geometrickou informaci o okolí bodu, a využít ji k jeho normalizaci. V závislosti na množství informace (kovarianci záchytních bodů), která je o okolí záchytného bodu k dispozici z detektoru, může být výslední popis pozičně, similaritně, afinně nebo perspektivně invariantní. 
</p>

</div>

<h2><a name="geometricka_normalizace" id="geometricka_normalizace">Geometrická normalizace</a></h2>
<div class="level2">

<p>
Geometrickou normalizací nazýváme process geometrické transformace okolí bodu v obrázku do kanonického souřadného systému.
Informace o geometrické transformaci okolí budeme uchovávat ve formě tzv. rámce – projekce kanonického souřadného systému do okolí záchytného bodu nebo oblasti v obrázku. Rámec reprezentujeme 3 x 3 transformací A, podobně jako na <a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/1_uvod/start#geometricke_transformace_a_interpolace_jasove_funkce" class="wikilink1" title="courses:a4m33mpv:cviceni:1_uvod:start">prvním cvičení</a>. Transformaci A využijeme k získání výřezu, malého okolí záchytného bodu v kanonickém souřadném systému. Všechny další měrení na tomhle typicky čtvercovém výrězu původního obrázku jsou teď již invariantní k odpovídající geometrické transformaci scény.

</p>
<table class="inline">
	<tbody><tr class="row0">
		<td class="col0 centeralign">  Původní obrázek  </td><td class="col1 centeralign">  Translace  </td><td class="col2 centeralign">  Translace<br>
a rotace  </td><td class="col3 centeralign">  Similarita  </td><td class="col4 centeralign">  Afinní <br>
transformace  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  <a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/cutoff1.jpg?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:cutoff1.jpg"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/cutoff1.jpg" class="media" title="cutoff1.jpg" alt="cutoff1.jpg" width="150" height="150"></a>  </td><td class="col1 centeralign">  <a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/translation1.jpg?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:translation1.jpg"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/translation1.jpg" class="media" title="translation1.jpg" alt="translation1.jpg" width="100"></a>  </td><td class="col2 centeralign">  <a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/euclidean1.jpg?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:euclidean1.jpg"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/euclidean1.jpg" class="media" title="euclidean1.jpg" alt="euclidean1.jpg" width="100"></a>  </td><td class="col3 centeralign">  <a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/similarity1.jpg?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:similarity1.jpg"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/similarity1.jpg" class="media" title="similarity1.jpg" alt="similarity1.jpg" width="100"></a>  </td><td class="col4 centeralign">  <a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/affine1.jpg?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:affine1.jpg"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/affine1.jpg" class="media" title="affine1.jpg" alt="affine1.jpg" width="100"></a>  </td>
	</tr>
	<tr class="row2">
		<td class="col0 centeralign">  <a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/cutoff2.jpg?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:cutoff2.jpg"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/cutoff2.jpg" class="media" title="cutoff2.jpg" alt="cutoff2.jpg" width="150" height="150"></a>  </td><td class="col1 centeralign">  <a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/translation2.jpg?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:translation2.jpg"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/translation2.jpg" class="media" title="translation2.jpg" alt="translation2.jpg" width="100"></a>  </td><td class="col2 centeralign">  <a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/euclidean2.jpg?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:euclidean2.jpg"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/euclidean2.jpg" class="media" title="euclidean2.jpg" alt="euclidean2.jpg" width="100"></a>  </td><td class="col3 centeralign">  <a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/similarity2.jpg?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:similarity2.jpg"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/similarity2.jpg" class="media" title="similarity2.jpg" alt="similarity2.jpg" width="100"></a>  </td><td class="col4 centeralign">  <a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/affine2.jpg?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:affine2.jpg"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/affine2.jpg" class="media" title="affine2.jpg" alt="affine2.jpg" width="100"></a>  </td>
	</tr>
	<tr class="row3">
		<td class="col0 centeralign" colspan="5">  Ukázka geometrické normalizace výřezu, různými třídami transformací (autorem obrázků je Štepán Obdržálek).  </td>
	</tr>
</tbody></table>

<p>

Pro konstrukci transformace A můžeme použít geometrické informace o pozici a tvaru okolí bodu následovně:
</p>
<ol>
<li class="level1"><div class="li">
 Pro rotačně a translačně kovariatní bod máme souřadnice x,y a úhel <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(33).php" class="latex" title="Graph" alt="Graph"> a  velikost rámce stejná pro všechny body (a zvolená manuálně). Pak<br>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(34).php" class="latex" title="Graph" alt="Graph">
</div></li>
<li class="level1"><div class="li">
 Pro similaritní bod souřadnice x,y velikost okolí <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(21).php" class="latex" title="Graph" alt="Graph"> a úhel <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(33).php" class="latex" title="Graph" alt="Graph">. Matici A dostaneme<br>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(35).php" class="latex" title="Graph" alt="Graph">
</div></li>
<li class="level1"><div class="li">
 Pri afinně kovariatním bode nebo oblasti máme náme tři body na které se promítnou body z kanonického souřadného systému, viď predposlední úkol prvního cvičení. Nebo je pro bod známa pozice, částečná afinní transformace a zbytková rotace o úhel <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(33).php" class="latex" title="Graph" alt="Graph">. Matici A pak složíme z translace a 2×2 podmatice následovně <br>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(36).php" class="latex" title="Graph" alt="Graph">
</div></li>
</ol>


<p>

Mnohé detektory (všechy z předchozího cvičení) vrácí body (rámce), jenž jsou určeny similaritně nebo afinně kovariatné až na neznámou rotaci (úhel <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(33).php" class="latex" title="Graph" alt="Graph">). Napr. pozice a měrítko bodu nám dají similaritně kovariatní bod, až na neznámou rotaci. Podobně matice druhých momentů a těžiště nám dají pět omezení na afinní transformaci a zbýva nám určit rotaci okolí bodu. Pro získaní plně similaritně nebo afinně kovariatního bodu potřebujeme z částečně geometricky normalizovaného okolí (pri normalizaci jsme použili nějakou hodnotu úhlu <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(33).php" class="latex" title="Graph" alt="Graph">) určit orientaci bodu. 
</p>

<p>
Normalizace s určením orientace musí probíhat většinou ve dvou krocích. Nejdříve se zhotoví výřez obrázku, jenž je nezávislý na translaci, velikosti případně častečné afinní transformaci (rotační matice z příkladu výše se předpokládá jednotková). Označme tuto matici <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(37).php" class="latex" title="Graph" alt="Graph">. Na výřezu znormalizovaném maticí <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(37).php" class="latex" title="Graph" alt="Graph"> se pak se určí orientace dominantního gradientu (reprezentována rotační maticí) a složí se s <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(37).php" class="latex" title="Graph" alt="Graph"> do celkové transformace A. Tato se pak použije ke konečné transformaci bodu. 
</p>

<p>
Pro určení dominatní orientace se na výřeze, částečne znormalizovaném transformací <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(37).php" class="latex" title="Graph" alt="Graph">, se v každém bodě odhadne velikost a orientace gradientu a spočítá se histogram gradientů. Protože předpokládáme náhodné natočení výřezu je potřeba gradienty akumulovat jenom za kruhové okolí napr. pomocí váhování okenní funkcí, nebo podmínkou (x-stredx)^2+(y-stredy)^2 &lt; (ps/2)^2, kde ps je velikost hrany výřezu. Jinak by orientaci ovlyvnil obsah “rohů” výřezu, jenž ale může být při jiném natočení jiný. Gradienty jsou váhovány jejich velikosti, větší gradient znamená vyšší příspevěk do odpovídajícího binu histogramu. Pro zvýšení robustnosti se hlas může rozdělit lineární interpolací do sousedních binů. Na závěr se histogram vyfiltruje 1D Gaussiánem a najde lokální maximum. Pro přesnou lokalizaci je možné do okolí maxima fitnout parabolu a najít orientaci s presností větší než 360/počet binů stupňů.
</p>
<ul>
<li class="level1"><div class="li">
 napište funkci <code>angle=dom_orientation(img)</code> pro odhad dominantní orientace gradientu v normalizovaném výřeze obrázku. Vstupem bude částečně normalizovaný výřez obrázku (ps x ps matice typu double), výstupem hodnota úhlu (v radiánech v intervalu &lt; -pi, pi&gt;) od osi x obrázku, měrená po směru hodinových ručiček (úhel vám pro vektor (x,y) spočítá funkce <code>atan2(y,x)</code>). Volitelně může funkce vrátit více než jednu orientaci, orientace budou seřazeny dle “dominantnosti” gradientu od největšího po nejmenší. 
</div></li>
</ul>


<p>

Teď již můžeme napsat funkce pro geometrickou normalizaci okolí bodů s využitím dominantní orientace. Napište funkce pro výpočet reprezentace bodů pomocí transformačních matic  a normalizovaných výřezů:
</p>
<ul>
<li class="level1"><div class="li">
 při známe pozici bodu, funkci <code>pts=transnorm(img,x,y,s,opt)</code> kde <em>img</em> bude vstupní obrázek <em>x</em>,<em>y</em> řádkové vektory se souřadnicemi bodů a <em>s</em> - skalární hodnota, měrítko bodů (pro všechny body stejné).
</div></li>
<li class="level1"><div class="li">
 při známe pozici a měrítku bodu, funkci <code>pts=simnorm(img,x,y,s,opt)</code> kde <em>img</em> bude vstupní obrázek <em>x</em>,<em>y</em> řádkové vektory se souřadnicemi bodů a <em>s</em> - <strong>řádkový vektor</strong> s měřítky bodů (viď, výstup z funkce sshessian).
</div></li>
<li class="level1"><div class="li">
 při známe pozici a částečné afinní transformaci bodu, funkci <code>pts=affnorm(img,x,y,a11,a12,a21,a22,opt)</code> kde <em>img</em> bude vstupní obrázek <em>x</em>,<em>y</em> řádkové vektory se souřadnicemi bodů a <em>a11,a12,a21,a22</em> - řádkové vektory s afinní transformací bodů.
</div></li>
</ul>


<p>

Vstupním parametrem <em>opt</em> bude struktura s parametry normalizace:

</p>
<pre class="code">opt.ps - velikost výřezu
opt.ext - velikost okolí bodu v kanonickém souřadném systému</pre>
<p>
<strong>Výstupem funkcí</strong> bude jednorozměrné pole struktur <em>pts</em>, které bude pro každý bod obsahovat: souřadnice <code>x</code>,<code>y</code>, 2×2 část transformační matice  v prvcích <code>a11</code>,<code>a12</code>,<code>a21</code>,<code>a22</code>, a normalizovaný výřez obrázku (ps x ps matice typu double) v prvku <code>patch</code>. Pro implementaci funkcí použijte jejich hierarchii, jednodušší funkce může vhodným voláním použít složitější funkci. Výslední výřez i výřez pro určení dominantní orientace vám spočítá funkce <code>affinetr</code>. Pseudokód normalizace s zjištěním orientace:
</p>
<pre class="matlab code matlab" style="font-family:monospace;"><span class="co1">% ... pro všechny body (id) ...</span>
A_norm = zostav_matici_A_bez_rotace<span class="br0">(</span>x<span class="br0">(</span>id<span class="br0">)</span>,y<span class="br0">(</span>id<span class="br0">)</span>,<span class="sy0">...</span><span class="br0">)</span>;
<span class="co1">% urceni orientace</span>
tmp = affinetr<span class="br0">(</span>img, A_norm, opt.<span class="me1">ps</span>, opt.<span class="me1">ext</span><span class="br0">)</span>;
<a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/angle.html"><span class="kw2">angle</span></a> = dom_orientation<span class="br0">(</span>tmp<span class="br0">)</span>;
<span class="co1">% finalni A, dame dominantni orientaci na 0 stupnu</span>
R = rotace_2x2<span class="br0">(</span>-<a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/angle.html"><span class="kw2">angle</span></a><span class="br0">)</span>; A<span class="br0">(</span>1:2,1:2<span class="br0">)</span> = A_norm<span class="br0">(</span>1:2,1:2<span class="br0">)</span>*R;
<span class="co1">% zostav vystup</span>
pts<span class="br0">(</span>id<span class="br0">)</span>.<span class="me1">x</span>=x<span class="br0">(</span>id<span class="br0">)</span>; pts<span class="br0">(</span>id<span class="br0">)</span>.<span class="me1">y</span>=y<span class="br0">(</span>id<span class="br0">)</span>;
pts<span class="br0">(</span>id<span class="br0">)</span>.<span class="me1">a11</span>=A<span class="br0">(</span>1,1<span class="br0">)</span>;
<span class="sy0">...</span>
<span class="me1">pts</span><span class="br0">(</span>id<span class="br0">)</span>.<a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/patch.html"><span class="kw2">patch</span></a>=affinetr<span class="br0">(</span>img, A, opt.<span class="me1">ps</span>, opt.<span class="me1">ext</span><span class="br0">)</span>;</pre>
<p>
<font color="red">V této úloze se kvůli názornosti používa při normalizaci jenom orientace odpovídající nejsilnějšímu gradientu.</font>
</p>

</div>

<h2><a name="fotometricka_normalizace" id="fotometricka_normalizace">Fotometrická normalizace</a></h2>
<div class="level2">

<p>

Fotometrická normalizace ma za cíl potlačit změny scény způsobeny změnou osvetlení. Nejjednodušší normalizace je roztáhnutí jasového kanálu tak aby se využil celý rozsah intenzit. Další možnost je roztáhnutí jasového kanálu tak aby po transformaci střední hodnota odpovídala půlce intenzitního rozsahu a směrodatní odchylka intenzit <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(21).php" class="latex" title="Graph" alt="Graph"> jeho rozsahu (případně <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(38).php" class="latex" title="Graph" alt="Graph">). V případě, že chceme využít všechny tři barevné kanály, normalizujeme každou složku zvlášť.
</p>
<ul>
<li class="level1"><div class="li">
 Napište funkci <code>ptsn=photonorm(pts)</code>, která pro každý bod v poli struktur <em>pts</em> fotometricky znormalizuje výřez obrázku (v poli <code>patch</code>) tak aby střední hodnota na výřezu byla 0,5 a směrodatná odchylka 0,2. Hodnoty jenž budou mimo rozsah &lt;0,1&gt; nastaví na mezní hodnoty. Funkce a vrátí pole struktur <em>ptsn</em> o stejné velikosti jako <em>pts</em> s modifikovaným výřezem v poli <code>patch</code> a uloží hodnoty původní střední hodnoty a směrodatné odchýlky do pole <code>mean</code> a <code>std</code>.
</div></li>
</ul>


</div>

<h2><a name="vypocet_popisu" id="vypocet_popisu">Výpočet popisu</a></h2>
<div class="level2">

<p>
Na geometricky a fotometricky invariantním výrězu obrázku z předchozího kroku můžeme spočítat libovolný nízkodimenzionální popis. Je zřejmé, že proces normalizace není úplně bezchybný a proto je žádoucí aby výpočet popisu nebyl príliš citlivý k zbývajícím neprěsnostem. Nejjednodušší popis je samotný výřez obrazku, medzi jeho nevýhody patří hlavně vysoká dimenze popisu, citlivost k malým posunom a lokálním změnám intenzity. Vyzkoušíme si proto kromě tohto popisu lepší varianty.

</p>
<ol>
<li class="level1"><div class="li">
 popis využívající dvourozměrnou diskrétní kosínusovou transformaci (DCT). Koeficienty této integrální transformace vzniknou skalárním součinem výrězu obrázku s tzv. DCT bázovými funkcemi viď. obrázek: <br>
<a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/dct_basefn.png?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:dct_basefn.png"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/dct_basefn.png" class="media" title="Obr&aacute;zek prvn&iacute;ch 8 b&aacute;zov&yacute;ch funkc&iacute; v každ&eacute; z dimenz&iacute;&iacute; dvourozměrn&eacute; DCT." alt="Obr&aacute;zek prvn&iacute;ch 8 b&aacute;zov&yacute;ch funkc&iacute; v každ&eacute; z dimenz&iacute;&iacute; dvourozměrn&eacute; DCT."></a> <a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/zigzag.png?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:zigzag.png"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/zigzag.png" class="media" title="Zig-zag pořad&iacute; koeficientů" alt="Zig-zag pořad&iacute; koeficientů" width="346" height="346"></a><br>
Výřez obrázku je takto rozložen na jednotlivé “frekvence” podobně jako u <acronym title="Joint Photographics Experts Group">JPEG</acronym> komprese. Podobně jako u komprese obrázků vybereme podmnožinu těchto koeficientů obsahující informaci o nízkých frekvencích. Tím dosáhneme odolnost popisu k vysokofrekvenčnímu šumu a do jisté míry i k nepřesnostem v geometrické normalizaci. Z obrázku bázových funkcí vidíme, že výběr DCT koeficientů budeme provádet v tzv. <a href="http://en.wikipedia.org/wiki/JPEG#Entropy_coding" class="urlextern" title="http://en.wikipedia.org/wiki/JPEG#Entropy_coding" rel="nofollow">zig-zag</a> pořadí, kdy budeme přidávat postupne vyšší a vyšší frekvence.
</div><ul>
<li class="level2"><div class="li">
 napište funkci <code>dct=dctdesc(img,num_coeffs)</code>, která spočíta pro vstupní výřez DCT transformaci a vrátí prvních <em>num_coeffs</em> koeficientů v zig-zag pořadí. Hodnoty koeficientů normalizujte do rozsahu &lt;0,1&gt;.
</div></li>
</ul>
</li>
<li class="level1"><div class="li">
 (volitelný úkol) RGB histogram, RG histogram, histogram gradientů jsou metody využívající globálních vlastnosti výřezu obrázku. Barevné kanály obrázku (napr. R,G,B) se nejdříve spracují a vypočtou se charakteristiky jenž se následne kvantizují do binů a spočítají. Výsledný popis je tvořen lineárním vektorem, počtami v jednotlivých binech. RG projekce nebo tzv. <a href="http://en.wikipedia.org/wiki/Rg_chromaticity" class="urlextern" title="http://en.wikipedia.org/wiki/Rg_chromaticity" rel="nofollow">chromacity</a> barevný prostor má dvě složky <br>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(39).php" class="latex" title="Graph" alt="Graph">, <br>
vyjádřuje podíl červené a zelené složky v obraze. Výhodou histogramů výřezu je necitlivost k nepřesnostem geometrické normalizace, nevýhodou je nižší rozlišovací schopnost tzv. distinktivita. 
</div><ul>
<li class="level2"><div class="li">
 napište funkci <code>dxdy=ghistodesc(img,num_bins)</code>, která spočítá histogram gradientů, <em>num_bins</em> je počet binů na kanál, t.j. výslední <em>dxdy</em> popis bude sloupcový vektor s <em>num_bins</em><sup>2</sup> elementů histogramu (velikost gradientu v dx - řádek, dy - sloupec) po sloupcích (matlab operator (:) ). Elementy normalizujte do rozsahu &lt;0,1&gt; (0 - žádný výskyt, 1 - výskyt v každém bodě výřezu).
</div></li>
</ul>
</li>
</ol>


</div>

<h2><a name="sift_popis_-_lokalni_histogram_orientaci_volitelny_ukol" id="sift_popis_-_lokalni_histogram_orientaci_volitelny_ukol">SIFT popis - Lokální histogram orientací (volitelný úkol)</a></h2>
<div class="level2">
<ol>
<li class="level1"><div class="li">
 lokální histogramy řeší problém s rozlišovací schopností tím, že se výřez rozdělí na menší částečně prěkrývající se části a histogramy se akumulují v těchto částech. Nejpoužívanější popis založený na lokálních histogramech je <a href="http://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf" class="urlextern" title="http://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf" rel="nofollow">SIFT</a>. SIFT je lokální histogram orientací gradientů ve čtvercové mřížce. Výřez se rozdělí do pravidelné mřížky nejčastěji 4×4 a v každém čtverci se spočíta histogram gradientů vážený jejich velikostí rozdělen na 8 orientací. Pro zrobustnení vůči nepřesnosti geometrické normalizace se velikosti gradientů váhují okenní funkcí (o velikosti sigma=ps/6). Dále se každý čtvěrec 4×4 mřížky zvetší tak, aby zasahoval do půlky hrany svých sousedů. Stejně hlasování do binů orientací se provádí lineární interpolací do dvou sousedních binů. Takto spočítaný popis je velice robustní a hodně používán. <br>

</div></li>
</ol>


<p>
<a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/gradient-descriptor.png?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:gradient-descriptor.png"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/gradient-descriptor.png" class="mediacenter" title="SIFT deskriptor" alt="SIFT deskriptor"></a> <br>

</p>
<ul>
<li class="level1"><div class="li">
 napište funkci <code>sift=siftdesc(img)</code>, která na výřeze obrázku spočítá SIFT popis se 4×4 histogramy o 8mi orientacích. Výsledný popis sloupcový vektor o 128položkách normalizujte na velikost 1.0, v případě že některá složka přesáhne hodnotu 0.2, nastavte ji na 0.2 a opakujte normalizaci.
</div></li>
</ul>


</div>

<h2><a name="co_odevzdat1" id="co_odevzdat1">Co odevzdat</a></h2>
<div class="level2">

<p>
Očekávame, že odevzdáte funkce transnorm.m, simnorm.m, affnorm.m, photonorm.m, dom_orientation.m a dctdesc.m spolu se všemi potřebnými funkcemi. Nezapomeňte na dátovou sadu. Volitelně můžete za dva body navíc odevzdat funkci siftdesc.m.
</p>

</div>

<h2><a name="kontrola_vysledku1" id="kontrola_vysledku1">Kontrola výsledků</a></h2>
<div class="level2">

<p>
Pro kontrolu výsledků vašich funkcií jsme použili skript a funkci MATLABu publish. Nakopírujte <a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/desc_test.zip" class="media mediafile mf_zip" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:desc_test.zip">desc_test.zip</a>, rozbalte ho do cesty MATLABu (nebo adresáře s vašimi funkcemi) a spusťte. <a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/desc_results.zip" class="media mediafile mf_zip" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:desc_results.zip">Výsledky</a> si ověrte porovnáním s <a href="http://cmp.felk.cvut.cz/~perdom1/mpv/03_desc/test.html" class="urlextern" title="http://cmp.felk.cvut.cz/~perdom1/mpv/03_desc/test.html" rel="nofollow">referenčním řešením</a>. Test i řešení ještě doplním (o chybějící funkce).
</p>

</div>

<h2><a name="reference1" id="reference1">Reference</a></h2>
<div class="level2">
<ol>
<li class="level1"><div class="li">
 <a href="http://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf" class="urlextern" title="http://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf" rel="nofollow">David G. Lowe, "Distinctive image features from scale-invariant keypoints," International Journal of Computer Vision, 60, 2 (2004), pp. 91-110.</a>
</div></li>
<li class="level1"><div class="li">
 <a href="http://lear.inrialpes.fr/pubs/2005/MS05/mikolajczyk_pami05.pdf" class="urlextern" title="http://lear.inrialpes.fr/pubs/2005/MS05/mikolajczyk_pami05.pdf" rel="nofollow">Porovnání různých metod generování lokálních popisů</a>.
</div></li>
</ol>


</div>

<h1><a name="hledani_tentativnich_korespondenci_a_ransac" id="hledani_tentativnich_korespondenci_a_ransac">3. Hledání tentativních korespondencí a RANSAC</a></h1>
<div class="level1">

</div>

<h2><a name="priprava" id="priprava">Příprava</a></h2>
<div class="level2">

<p>

Dřív, než začneme, budeme potřebovat funkci <code>pts=detect_and_describe(img,detpar,descpar)</code>, jenž zapojí do výpočtu všechny funkce z předchozích cvičení a v obrázku <em>img</em> zdetekuje, geometricky a fotometricky znormalizuje a popíše záchytné body. Parametry detektoru se jí předají ve struktuře <em>detpar</em>:
</p>
<ul>
<li class="level1"><div class="li">
 pro Hessian detektor: <br>
<pre class="matlab code matlab" style="font-family:monospace;">detpar.<a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/type.html"><span class="kw2">type</span></a>=<span class="co2">'hessian'</span>;
detpar.<span class="me1">sigma</span> <span class="co1">% sigma pro vypocet derivaci</span>
detpar.<span class="me1">threshold</span> <span class="co1">% prah</span></pre>
<p>

</p></div></li>
<li class="level1"><div class="li">
 pro Harris detektor: <br>

<p></p>
<pre class="matlab code matlab" style="font-family:monospace;">detpar.<a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/type.html"><span class="kw2">type</span></a>=<span class="co2">'harris'</span>;
detpar.<span class="me1">sigmad</span> <span class="co1">% derivacni sigma</span>
detpar.<span class="me1">sigmai</span> <span class="co1">% integracni sigma</span>
detpar.<span class="me1">threshold</span> <span class="co1">% prah</span></pre>
<p>

</p></div></li>
<li class="level1"><div class="li">
 pro Hessian detektor v prostoru měřítek <br>

<p></p>
<pre class="matlab code matlab" style="font-family:monospace;">detpar.<a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/type.html"><span class="kw2">type</span></a>=<span class="co2">'sshessian'</span>;
detpar.<span class="me1">threshold</span> <span class="co1">% prah</span></pre>
<p>

</p></div></li>
<li class="level1"><div class="li">
 pro MSER detektor <br>

<p></p>
<pre class="matlab code matlab" style="font-family:monospace;">detpar.<a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/type.html"><span class="kw2">type</span></a>=<span class="co2">'mser'</span>;
detpar.<span class="me1">min_margin</span> <span class="co1">% pozadovana stabilita</span>
detpar.<span class="me1">min_size</span>   <span class="co1">% velikost nejmensi oblasti v pixlech</span>
detpar.<span class="me1">max_area</span>   <span class="co1">% procento/100 plochy nejvetsi detekovane oblasti (v rozsahu 0 az 1).</span></pre>
</div></li>
</ul>


<p>
Parametry normalizace a typu popisu dostane ve struktuře <em>descpar</em> <br>

</p>
<pre class="matlab code matlab" style="font-family:monospace;">descpar.<a href="http://www.mathworks.com/access/helpdesk/help/techdoc/ref/type.html"><span class="kw2">type</span></a> <span class="co1">% typ popisu ('dct' nebo 'ghisto' nebo 'sift')</span>
descpar.<span class="me1">ps</span> <span class="co1">% velikost výřezu</span>
descpar.<span class="me1">ext</span> <span class="co1">% velikost okolí bodu v kanonickém souřadném systému.</span></pre>
<p>

pro popis dct navíc: 
</p>
<pre class="code matlab">descpar.<span class="me1">num_coeffs</span> <span class="co1">% pocet koeficientu v zig-zag poradi</span></pre>

<p>

a pro popis ghisto: 
</p>
<pre class="code matlab">descpar.<span class="me1">num_bins</span> <span class="co1">% pocet binu na jedné osi histogramu.</span></pre>

<p>
Na výstupu vrátí body ve struktuře pts ve formátu funkce <code>affnorm</code> (pole x,y,a11,a12,a21,a22,patch) a <code>photonorm</code> (mean, std) z minulého cvičení, každému bodu  doplní pole <code>pts(i).desc</code> se spočteným popisem jako sloupcovým vektorem. Funkci si můžete stáhnout <a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/detect_and_describe.m" class="media mediafile mf_m" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:detect_and_describe.m">zde</a>.
</p>

</div>

<h2><a name="tentativni_korespondence" id="tentativni_korespondence">Tentativní korespondence</a></h2>
<div class="level2">

<p>
Po detekci a generování popisu, jenž probíhali na každém obrázku scény nezávisle, prikročíme k vlastnímu hledání korespondencí. První fází je nalezení tzv. tentativních korespondencí (někdy nazývaných i “matchů”). Tentativní korespondence je pár – dvojice popisů, jenž jsou si v nějaké vzdálenosti podobné. Nejjednodušší metodou pro nalezení korespondencí je najít vzdálenosti mezi všemi páry popisů. Tuto tabulku nazveme maticí vzdáleností. Jako kritérium podobnosti popisů použijte euklidovskou vzdálenost. Označme si obrázky v nichž hledáme korespondence pravý a levý. Zkusíme si několik metod výběru tentativních korespondencí:

</p>
<ol>
<li class="level1"><div class="li">
 Tentativní korespondence <strong>vzájemně nejbližších</strong> popisů vznikne, pokud zvolený popis A z pravého obrázku má ze všech popisů z levého obrázku nejbližší popis B a zároveň, popis B má nejbližší ze všech popisů v pravém obrázku popis A.
</div></li>
<li class="level1"><div class="li">
 Při (slabém) <strong>stabilním párovaní</strong> popisů, postupujeme jinak. V každém kroku algoritmu najdeme globálně nejbližší popisy A a B. Vytvoříme tentativní korespondenci a popisy A a B vyloučíme z dalšího hledání (např. nastavením vzdáleností příslušného řádku sloupce na nekonečno). Postup opakujem pokud zůstali v matici vzdáleností nějaké aktivní prvky (hodnoty menší než nekonečno).
</div></li>
<li class="level1"><div class="li">
 Jiný postup je najít ke každému popisu z levého obrazu nejbližší dva v pravém obrazu. Když je poměr vzdáleností <strong>prvního/druhého nejbližšího</strong> popisu menší než např. 0.8, popisy korespondují, a zároveň je zaručeno, že v jistém “okolí” v prostoru popisů není žádný bod s kterým by sme si ho mohli splést. Tuto metodu je možné použít pro diskriminativní popisy, např. SIFT.
</div></li>
</ol>


<p>

Výstupem hledání tentativních korespondencí jsou dvojice indexů, párů z levého a pravého obrázku s nejpodobnějšími popisy.
</p>
<ul>
<li class="level1"><div class="li">
 napište funkci <code>corrs=match(pts1, pts2, par)</code>, jenž pro body <code>pts1</code> a <code>pts2</code> zadané strukturami nalezne korespondence metodou specifikovanou ve struktuře <code>par</code>. Popisy bodů jsou pro každý bod  uloženy v poli <code>pts1(i).desc</code> resp. <code>pts2(i).desc</code>. Metoda je specifikovaná ve struktuře par poli par.method jako řetezec. Pro každou z metod ignorujte dvojice popisů (tentativní korespondence) se vzdáleností větší než práh <code>par.threshold</code>. <br>

</div></li>
</ul>

<pre class="code matlab">par.<span class="me1">method</span> = <span class="co2">'mutual'</span>; <span class="co1">% pro metodu vzajemne nejblizsich popisu </span>
             <span class="co2">'stable'</span>; <span class="co1">% pro metodu slabeho parovani a </span>
             <span class="co2">'sclosest'</span>; <span class="co1">% pro metodu prvni/druhy nejblizsi</span>
par.<span class="me1">threshold</span> <span class="co1">% prah, dvojice popisu s euklidovskou vzdalenosti vyssi nez prah se ignoruji</span></pre>

<p>

Výstupem bude matice 2xN, indexů tentativních korespondencí, kde první řádek budou indexy do pole pts1 a druhý řádek indexy do pole pts2.
</p>

</div>

<h2><a name="ransac_a_geometricky_model_sceny" id="ransac_a_geometricky_model_sceny">RANSAC a geometrický model scény</a></h2>
<div class="level2">

<p>

Dvojice bodů získané v předchozím kroku na základě podobnosti zpravidla obsahují mnoho nekorespondujících bodů (nazývají se outliers), tedy tentativních korespondencí, jenž mají podobné popisy ale neodpovídají jednomu fyzickému prvku scény. Cílem poslední fáze hledání korespondencí je zbavit se těchto bodů za předpokladu o možné transformaci scény mezi dvěma pohledy. Výsledkem je nalezení modelu – transformace scény a množiny tzv. inlierů, tentativních korepsondencí, jenž jsou konzistentní s nalezeným modelem.
</p>

</div>

<h3><a name="nalezeni_transformace_rovinne_sceny" id="nalezeni_transformace_rovinne_sceny">Nalezení transformace rovinné scény</a></h3>
<div class="level3">

<p>
S transformací rovinné scény jste se již mohli setkat na předmětu <a href="http://cmp.felk.cvut.cz/cmp/courses/DZO/Lab03/lab03.html#u2" class="urlextern" title="http://cmp.felk.cvut.cz/cmp/courses/DZO/Lab03/lab03.html#u2" rel="nofollow">Digitální obraz</a>. Pro připomenutí si můžete znovu prostudovat <a href="http://cmp.felk.cvut.cz/cmp/courses/383ZS/X383ZS2005-6_Leto/cvic3/geomtransf.pdf" class="urlextern" title="http://cmp.felk.cvut.cz/cmp/courses/383ZS/X383ZS2005-6_Leto/cvic3/geomtransf.pdf" rel="nofollow">dokument o hledání projektivní transformace</a>. Ve zkratce:
</p>

<p>
Transformace roviny mezi dvěma pohledy perspektivní kamery je lineární transformace (nazývaná taky <strong>homografie</strong>) 3-dimenzionálních homogenních vektorů (korespondujících bodů v homogenních souřadnicích) reprezentovaná regulární <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(40).php" class="latex" title="Graph" alt="Graph"> maticí <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(41).php" class="latex" title="Graph" alt="Graph">:
</p>

<p>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(42).php" class="latex" title="Graph" alt="Graph">
</p>

<p>
Pro každý korespondující pár <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(43).php" class="latex" title="Graph" alt="Graph"> platí
</p>

<p>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(44).php" class="latex" title="Graph" alt="Graph">
</p>

<p>
Pro korespondující páry můžeme zostavit systém rovníc:
</p>

<p>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(45).php" class="latex" title="Graph" alt="Graph">
</p>

<p>
Tento homogénní systém rovníc má 9 neznámých. Jedno netriviální řešení dostaneme jako pravý nulový prostor matice <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(10).php" class="latex" title="Graph" alt="Graph">. Pro jednoznačné řešení potřebujeme, aby matice <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(10).php" class="latex" title="Graph" alt="Graph"> měla alespoň 8 lineárne nezávislých řádků, t.j. 8 omezení ze 4 korespondujících bodů v obecné poloze (žadné tři nesmí ležet na přímce).
</p>
<ul>
<li class="level1"><div class="li">
 napište funkci <code>H=u2h(u)</code>, která dostane matici 4 dvojic korespondujících bodů v homogénních souřadnicích a spočítá z nich homografii <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(41).php" class="latex" title="Graph" alt="Graph">. Matice <em>u</em> je rozměru 6×4: <code>[ x<sub>1</sub> x<sub>2</sub> … x<sub>4</sub>; y<sub>1</sub> y<sub>2</sub> … y<sub>4</sub>; 1 1 1 1 ; x'<sub>1</sub> x'<sub>2</sub> … x'<sub>4</sub>; y'<sub>1</sub> y'<sub>2</sub> … y'<sub>4</sub>; 1 1 1 1]</code>, kde x<sub>i</sub>,y<sub>i</sub> jsou body v levém obrázku a x'<sub>i</sub>,y'<sub>i</sub> v pravém. V případě, že bude nejaká trojice bodů blízka přímce, vráti prázdnou matici [].
</div></li>
<li class="level1"><div class="li">
 napište funkcie <code>dist=hdist(H,u)</code>, která dostane <em>u</em> matici N dvojic korespondujících bodů v homogénních souřadnicích t.j. matici 6xN a vrátí <em>dist</em> (matice 1xN) druhou mocninu vzdálenosti bodů <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(46).php" class="latex" title="Graph" alt="Graph"> a <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(47).php" class="latex" title="Graph" alt="Graph">. 
</div></li>
</ul>


</div>

<h3><a name="ransac" id="ransac">RANSAC</a></h3>
<div class="level3">

<p>
Pro nalezení modelu scény – správné projektivní transformace dvou rovin, potřebujeme alespoň čtyři bezchybné korespondence, které neleží na přímce. Abychom nalezli nejlepší projektivní transformaci mezi získanými dvojicemi bodů z tentativních korespondencí, použijeme algoritmus M.Fischlera a R.C.Bollese, RANSAC. 
</p>

<p>
V našem případě má algoritmus RANSAC (budete se ním podrobněji zabývat na prednášce) tuto formu:

</p>
<ol>
<li class="level1"><div class="li">
 Náhodně vybereme 4 korespondující páry, tzv. vzorek (sample). K vygenerování nahodné permutace můžete použít funkci <code><a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/sample.m" class="media mediafile mf_m" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:sample.m">sample.m</a></code>.
</div></li>
<li class="level1"><div class="li">
 Z těchto bodů vypočteme homografii <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(41).php" class="latex" title="Graph" alt="Graph">. 
</div></li>
<li class="level1"><div class="li">
 Zjistíme tzv. podporu nebo-li support nalezeného modelu. Je-li <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(41).php" class="latex" title="Graph" alt="Graph"> spočtená ze správných korespondencí, měly by transformované body <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(48).php" class="latex" title="Graph" alt="Graph"> ležet na místech korespondujících bodů <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(49).php" class="latex" title="Graph" alt="Graph"> v druhém obraze. Podporu modelu kvantifikujeme počtem bodů konzistentních s modelem. T.j. bodů se vzdáleností (viď funkce <code>hdist</code>) transformovaného bodu z levého obrázku a odpovídajícího bodu v pravém obrázku menší než zadaný práh (např. 1-3 pixely).
</div></li>
<li class="level1"><div class="li">
 Pokud je hodnota podpory nalezené homografie doteď největší, uložíme si její hodnotu, doteď-nejlepší-model <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(50).php" class="latex" title="Graph" alt="Graph"> a množinu inlierů nebo-li bodů které podporili tento model.
</div></li>
<li class="level1"><div class="li">
 Body 1-4 opakujeme iterativně, a hledáme takovou <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(50).php" class="latex" title="Graph" alt="Graph"> která správně transformuje největší počet korespondencí, tj. maximalizuje kritérium definované v bodě 3. 
</div></li>
</ol>


<p>

Počet iterací zvolte nejdříve 1000 a odlaďte RANSAC na lehkém páru obrázků. V praxi se použivá pro zastavení výpočtu sofistikovanější kritérium, než je pevně zadaný počet iterací. Je založeno na odhadu pravděpodobnosti nalezení správneho vzorku (sestávajícího v našem případě ze čtyř správných korespondencí) za předpokladu průběžně odhadovaného procenta inlierů. Kritérium je implementováno funkcí <code><a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/nsamples.m" class="media mediafile mf_m" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:nsamples.m">nsamples.m</a></code> a pro zvolenou pravděpodobnost <em>conf</em> spočítá potřebný celkový počet iterací: 

</p>
<pre class="matlab code matlab" style="font-family:monospace;">num_samples = nsamples<span class="br0">(</span>pocet_inlieru, pocet_paru, velikost_vzorku, conf<span class="br0">)</span>;</pre>
<p>

kde <em>pocet_inlieru</em> je průbežně odhadovaný, tj. při každém nalezení lepší transformace (dle kritéria v bodě 4) přepočítáme potřebný počet kroků funkcí <code>nsamples</code>. 
</p>
<ul>
<li class="level1"><div class="li">
 s využitím výše uvedených funkci pro určení modelu a vzdálenosti od homografie, napište funkci <code>[Hbest,inl]=ransac_h(u,threshold,confidence)</code>, která najde homografii <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(50).php" class="latex" title="Graph" alt="Graph"> a množinu inlierů <em>inl</em>. Vstupem budou dvojice souřadnic <em>u</em> (matice 6xN, dvojic odpovídajících si bodů v homogénních souřadnicích), podobně jako ve funkci <code>hdist</code>. Parametr <em>threshold</em> bude udávat maximální vzdálenost bodů pomocí funkce <code>hdist</code> jenž budou označeny jako inliery, konzistetní s výslední homografii <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(50).php" class="latex" title="Graph" alt="Graph">. Parametr <em>confidence</em> bude hodnota v intervalu (0,1), požadovaná pravděpodobnost správného výsledku (pro testování použijte napr. 0.95). <br>
Výstupem bude nejlepší nalezený model <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(50).php" class="latex" title="Graph" alt="Graph"> a pole inl 1xN, kde 0 bude znamenat outlier a 1 inlier, kde N je počet bodů, sloupců matice <em>u</em>.
</div></li>
</ul>


</div>

<h2><a name="vzajemna_poloha_dvou_kamer_epipolarni_geometrie" id="vzajemna_poloha_dvou_kamer_epipolarni_geometrie">Vzájemná poloha dvou kamer, epipolární geometrie</a></h2>
<div class="level2">

<p>

Aby jste mohli ověrit korespondence i pro jiné než rovinné scény, budeme potřebovat obecnejší vztah svazující dva body ve dvou kamerách. Tento vztah se pro dvojici perspektivních kamer jmenuje epipolární geometrie. Podrobněji se jí budete zabývat na předmětu A4M33TZ, pro zběžnou představu poslouží <a href="http://en.wikipedia.org/wiki/Epipolar_geometry" class="urlextern" title="http://en.wikipedia.org/wiki/Epipolar_geometry" rel="nofollow">wikipedie</a> nebo <a href="http://danielwedge.com/fmatrix/" class="urlextern" title="http://danielwedge.com/fmatrix/" rel="nofollow">písnička :)</a>. Pro nás je důležité, že epipolární geometrie je geometrický vztah korespondujících bodů <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(51).php" class="latex" title="Graph" alt="Graph"> a <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(52).php" class="latex" title="Graph" alt="Graph">, obrazů bodu  ve scéně viděného dvojicí perspektivních kamer:

</p>
<table class="inline">
	<tbody><tr class="row0">
		<td class="col0 centeralign">  <a href="http://cw.felk.cvut.cz/lib/exe/detail.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/500px-epipolar_geometry.svg.png?id=courses%3Aa4m33mpv%3Acviceni%3A2_hledani_korespondenci%3Astart" class="media" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:500px-epipolar_geometry.svg.png"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/500px-epipolar_geometry.svg.png" class="mediacenter" alt=""></a>  </td>
	</tr>
	<tr class="row1">
		<td class="col0 centeralign">  Epipolární geometrie, zdroj <a href="http://en.wikipedia.org/wiki/Epipolar_geometry" class="urlextern" title="http://en.wikipedia.org/wiki/Epipolar_geometry" rel="nofollow">wikipedie</a>  </td>
	</tr>
</tbody></table>

<p>

Tenhle vztah se dá matematicky vyjádřit:
</p>

<p>
<img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(53).php" class="latex" title="Graph" alt="Graph">
</p>

<p>
Epipolární geometrie je reprezentována maticí <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(54).php" class="latex" title="Graph" alt="Graph">, zvanou fundamentální matice. Pro její nalezení je potřebných alespoň 7 korespondujících bodů. Aby náš RANSAC fungoval pro hledání epipolární geometrie, budeme potřebovat dvě věci, funkci <code><a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/u2f7.m" class="media mediafile mf_m" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:u2f7.m">u2f7.m</a></code> pro výpočet modelu – fundamentální matice <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(54).php" class="latex" title="Graph" alt="Graph"> a funkci <a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/fds.m" class="media mediafile mf_m" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:fds.m">fds.m</a> pro nalezení vzdálenosti bodů od modelu, t.j. vzdálenosti od epipolární přímky (obrazu paprsku v druhé kamere). Funkce mají stejné parametre jako <code>u2h</code> a <code>hdist</code> jen matice <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(41).php" class="latex" title="Graph" alt="Graph"> se zamění za matici <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(54).php" class="latex" title="Graph" alt="Graph">. Funkce u2f7 může vrátit jedno (výsledek je 3×3 matice) nebo až tři řešení (3x3xpocet_reseni), je potřeba upravit verifikaci nalezeného modelu, tak aby zkusil najít nejlepší ze všech vrácených modelů.

</p>
<ul>
<li class="level1"><div class="li">
 s využitím výše uvedených funkci pro určení modelu a vzdálenosti od modelu epipolární geometrie, napište funkci <code>[Fbest,inl]=ransac_f(u,threshold,confidence)</code>, která najde fundamentální matici <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(55).php" class="latex" title="Graph" alt="Graph"> a množinu inlierů <em>inl</em>. Vstupem budou dvojice souřadnic odpovídajících si bodů (dle tentativních korespondencí) v homogénních souřadnicích, podobně jako ve funkci <code>hdist</code>. Parametr <em>threshold</em> bude udávat maximální vzdálenost bodů pomocí funkce <code>fds</code> jenž budou označeny jako inliery, konzistetní s výslední epipolární geometrii <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(55).php" class="latex" title="Graph" alt="Graph">. Parametr <em>confidence</em> bude hodnota v intervalu (0,1), požadovaná pravděpodobnost správného výsledku (pro testování použijte napr. 0.95).<br>
Výstupem bude nejlepší nalezený model <img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/fetch(55).php" class="latex" title="Graph" alt="Graph"> a pole inl 1xN, kde 0 bude znamenat outlier a 1 inlier, kde N je počet bodů, sloupců matice <em>u</em>.
</div></li>
</ul>


</div>

<h2><a name="zadani_ulohy_na_hledani_korespondenci" id="zadani_ulohy_na_hledani_korespondenci">Zadání úlohy na hledání korespondencí</a></h2>
<div class="level2">

<p>

Naprogramujte funkce detect_and_describe.m, match.m, u2h.m, hdist.m, ransac_h.m, ransac_f.m a odevzdajte je do úlohy <code>04_corr</code> spolu se všemi potřebnými funkcemi. 
</p>

<p>
Na vaší dátové sadě vyberte pro každý objekt nějakou kombinaci detektoru/popisu. Spusťte detektory a vygenerujte popisy pro všechny obrázky funkcí <code>detect_and_describe</code>. Uložte výsledky (strukturu <em>pts</em>) do souborů <code>obj%d_view%d.mat</code> spolu s konfigurací detektoru (<em>detpar</em>), normalizace a popisu (<em>descpar</em>). Obrázky i pohledy číslujeme od 0 (např. pro objekt 1 obrázek 3 bude výsledek: struktury <em>pts</em>, <em>detpar</em> a <em>descpar</em> uložen v souboru obj1_view3.mat, pro objekt 0 obrázek 0 v souboru obj0_view0.mat, atd.).
</p>

<p>
Vygenerujte tentativní korespondence pro každý objekt a všechny páry pohledů na objekt . Výsledkem bude matice <em>TC</em> cellů 5×5, jejíž prvky budou pole corrs z funkce <code>match</code>. Budeme předpokládat, že proces je symetrický (2→1 je to samé jako 1→2) a vygenerujeme jenom horní trojúhelník (index prvního obrázku bude řádek a index druhého sloupec) matice bez uhlopříčky. Výsledek, matici <em>TC</em> uložte spolu s konfigurací <em>par</em> metody <code>match</code> do souboru <code>obj%d_tc.mat</code>. 
</p>

<p>
Na závěr pro každý objekt pusťte oba RANSACy na vygenerovaných tentativních korespondencích a výsledky uložte do matic <em>H</em>, <em>F</em>, <em>inlH</em> a <em>inlF</em> cellů 5×5. Ostatní celly, dolní troúhelník matice a prvky na uhlopříčce nechte prázdné. Výsledek: matice cellů <em>H</em>, <em>F</em>, <em>inlH</em> a <em>inlF</em> znovu uložte do souboru <code>obj%d_results.mat</code> spolu s parametry thresh_h, thresh_f, conf_h, conf_f funkcí ransac_h a ransac_f.
</p>

<p>
<strong>Všechny výsledky zabalte do archivu a odevzdejte do úkolu <code>04_results</code>, pro snížení pamětové náročnosti zmažte ze struktur <code>pts</code> pole <code>patch</code>, funkcí <code>rmfield</code></strong>.
</p>

</div>

<h2><a name="kontrola_vysledku2" id="kontrola_vysledku2">Kontrola výsledků</a></h2>
<div class="level2">

<p>
Pro kontrolu správnosti odevzdaných funkcí jsme použili skript a funkci MATLABu publish. Nakopírujte si <a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/corr_test.zip" class="media mediafile mf_zip" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:corr_test.zip">corr_test.zip</a>, rozbalte ho do cesty MATLABu (nebo adresáře s vašimi funkcemi) a spusťte. <a href="http://cw.felk.cvut.cz/lib/exe/fetch.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/corr_results.zip" class="media mediafile mf_zip" title="courses:a4m33mpv:cviceni:2_hledani_korespondenci:corr_results.zip">Výsledky</a> si ověrte porovnáním s <a href="http://cmp.felk.cvut.cz/~perdom1/mpv/04_corr/test.html" class="urlextern" title="http://cmp.felk.cvut.cz/~perdom1/mpv/04_corr/test.html" rel="nofollow">referenčním řešením</a>.

</p>

</div>

<!-- cachefile /www/pages/data/cache/c/c5bfb9120b07ea2d9228d87d2907456a.xhtml used -->

    <!-- wikipage stop -->
  </div>
   <div id="sidebar">
    <div id="sidebar_content">
      


<div id="nojs_indexmenu_10517370224f4b782dd1cc7" class="indexmenu_nojs" style="display: none; ">

<ul class="idx">
<li class="closed"><div class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/start" class="indexmenu_idx_head">cviceni</a></div></li>
<li class="closed"><div class="li"><a href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/internal?idx=courses:a4m33mpv:internal" class="indexmenu_idx">internal</a></div></li></ul>
</div>
<script type="text/javascript" charset="utf-8">
<!--//--><![CDATA[//><!--
var indexmenu_10517370224f4b782dd1cc7 = new dTree('indexmenu_10517370224f4b782dd1cc7','default');
indexmenu_10517370224f4b782dd1cc7.config.urlbase='http://cw.felk.cvut.cz/doku.php/';
indexmenu_10517370224f4b782dd1cc7.config.sepchar='/';
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv',0,-1,'a4m33mpv','courses/a4m33mpv/start');
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/cviceni',1,0,'cviceni','courses/a4m33mpv/cviceni/start',1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/cviceni/1_uvod',2,1,'1_uvod','courses/a4m33mpv/cviceni/1_uvod/start',1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/cviceni/2_hledani_korespondenci',3,1,'2_hledani_korespondenci','courses/a4m33mpv/cviceni/2_hledani_korespondenci/start',1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/cviceni/3_indexace',4,1,'3_indexace','courses/a4m33mpv/cviceni/3_indexace/start',1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/cviceni/4_sledovani_objektu',5,1,'4_sledovani_objektu','courses/a4m33mpv/cviceni/4_sledovani_objektu/start',1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/cviceni/5_segmentace',6,1,'5_segmentace',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/cviceni/reseni',7,1,'reseni','courses/a4m33mpv/cviceni/reseni/start',1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/cviceni/plagiaty',8,1,'plagiaty',0,0,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal',9,0,'internal',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups',10,9,'backups',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/ls20102011_20110912',11,10,'ls20102011_20110912',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/ls20102011_20110912/cviceni',12,11,'cviceni',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/ls20102011_20110912/cviceni/1_uvod',13,12,'1_uvod',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/ls20102011_20110912/cviceni/2_hledani_korespondenci',14,12,'2_hledani_korespondenci',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/ls20102011_20110912/cviceni/3_indexace',15,12,'3_indexace',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/ls20102011_20110912/cviceni/4_sledovani_objektu',16,12,'4_sledovani_objektu',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/ls20102011_20110912/cviceni/5_segmentace',17,12,'5_segmentace',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/ls20102011_20110912/cviceni/reseni',18,12,'reseni',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/zs20110222',19,10,'zs20110222',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/zs20110222/cviceni',20,19,'cviceni',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/zs20110222/cviceni/1_uvod',21,20,'1_uvod',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/zs20110222/cviceni/2_hledani_korespondenci',22,20,'2_hledani_korespondenci',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/zs20110222/cviceni/3_indexace',23,20,'3_indexace',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/zs20110222/cviceni/4_sledovani_objektu',24,20,'4_sledovani_objektu',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/zs20110222/cviceni/5_segmentace',25,20,'5_segmentace',0,1,0);
indexmenu_10517370224f4b782dd1cc7.add('courses/a4m33mpv/internal/backups/zs20110222/cviceni/reseni',26,20,'reseni',0,1,0);
document.write(indexmenu_10517370224f4b782dd1cc7);
addInitEvent(function(){indexmenu_10517370224f4b782dd1cc7.init(0,0,"",1,0);});
//--><!]]>
</script><div id="cdtree_indexmenu_10517370224f4b782dd1cc7" class="dtree" style="position:relative;overflow:hidden;width:100%;"><div id="dtree_indexmenu_10517370224f4b782dd1cc7" class="dtree default" onclick="indexmenu_10517370224f4b782dd1cc7.divdisplay(&#39;r&#39;,0);" style="overflow:visible;position:relative;width:100%"><div id="tindexmenu_10517370224f4b782dd1cc7" class="indexmenu_tocbullet default" style="display:none;" title="Table of contents"></div><div id="toc_indexmenu_10517370224f4b782dd1cc7" style="display:none;"></div><div class="dTreeNode"><img id="iindexmenu_10517370224f4b782dd1cc70" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/base.gif" alt=""><a id="sindexmenu_10517370224f4b782dd1cc70" class="nodeFdUrl" href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/start" title="a4m33mpv" onmouseover="indexmenu_10517370224f4b782dd1cc7.show_feat(&#39;0&#39;);" onmousedown="return indexmenu_checkcontextm(&#39;0&#39;,indexmenu_10517370224f4b782dd1cc7,event);" oncontextmenu="return indexmenu_stopevt(event)" onclick="javascript: indexmenu_10517370224f4b782dd1cc7.s(0);">a4m33mpv</a></div><div id="dindexmenu_10517370224f4b782dd1cc70" class="clip" style="display:block;"><div class="dTreeNode"><a href="javascript: indexmenu_10517370224f4b782dd1cc7.o(1);"><img id="jindexmenu_10517370224f4b782dd1cc71" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/minus.gif" alt=""></a><img id="iindexmenu_10517370224f4b782dd1cc71" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/folderhopen.gif" alt=""><a id="sindexmenu_10517370224f4b782dd1cc71" class="nodeFdUrl" href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/start" title="cviceni" onmouseover="indexmenu_10517370224f4b782dd1cc7.show_feat(&#39;1&#39;);" onmousedown="return indexmenu_checkcontextm(&#39;1&#39;,indexmenu_10517370224f4b782dd1cc7,event);" oncontextmenu="return indexmenu_stopevt(event)" onclick="javascript: indexmenu_10517370224f4b782dd1cc7.s(1);">cviceni</a></div><div id="dindexmenu_10517370224f4b782dd1cc71" class="clip" style="display: block; "><div class="dTreeNode"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/line.gif" alt=""><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/join.gif" alt=""><img id="iindexmenu_10517370224f4b782dd1cc72" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/folderh.gif" alt=""><a id="sindexmenu_10517370224f4b782dd1cc72" class="nodeUrl" href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/1_uvod/start" title="1_uvod" onmouseover="indexmenu_10517370224f4b782dd1cc7.show_feat(&#39;2&#39;);" onmousedown="return indexmenu_checkcontextm(&#39;2&#39;,indexmenu_10517370224f4b782dd1cc7,event);" oncontextmenu="return indexmenu_stopevt(event)" onclick="javascript: indexmenu_10517370224f4b782dd1cc7.s(2);">1_uvod</a></div><div class="dTreeNode"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/line.gif" alt=""><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/join.gif" alt=""><img id="iindexmenu_10517370224f4b782dd1cc73" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/folderh.gif" alt=""><a id="sindexmenu_10517370224f4b782dd1cc73" class="navSel" href="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware].html" title="2_hledani_korespondenci" onmouseover="indexmenu_10517370224f4b782dd1cc7.show_feat(&#39;3&#39;);" onmousedown="return indexmenu_checkcontextm(&#39;3&#39;,indexmenu_10517370224f4b782dd1cc7,event);" oncontextmenu="return indexmenu_stopevt(event)" onclick="javascript: indexmenu_10517370224f4b782dd1cc7.s(3);">2_hledani_korespondenci</a></div><div class="dTreeNode"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/line.gif" alt=""><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/join.gif" alt=""><img id="iindexmenu_10517370224f4b782dd1cc74" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/folderh.gif" alt=""><a id="sindexmenu_10517370224f4b782dd1cc74" class="nodeUrl" href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/3_indexace/start" title="3_indexace" onmouseover="indexmenu_10517370224f4b782dd1cc7.show_feat(&#39;4&#39;);" onmousedown="return indexmenu_checkcontextm(&#39;4&#39;,indexmenu_10517370224f4b782dd1cc7,event);" oncontextmenu="return indexmenu_stopevt(event)" onclick="javascript: indexmenu_10517370224f4b782dd1cc7.s(4);">3_indexace</a></div><div class="dTreeNode"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/line.gif" alt=""><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/join.gif" alt=""><img id="iindexmenu_10517370224f4b782dd1cc75" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/folderh.gif" alt=""><a id="sindexmenu_10517370224f4b782dd1cc75" class="nodeUrl" href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/4_sledovani_objektu/start" title="4_sledovani_objektu" onmouseover="indexmenu_10517370224f4b782dd1cc7.show_feat(&#39;5&#39;);" onmousedown="return indexmenu_checkcontextm(&#39;5&#39;,indexmenu_10517370224f4b782dd1cc7,event);" oncontextmenu="return indexmenu_stopevt(event)" onclick="javascript: indexmenu_10517370224f4b782dd1cc7.s(5);">4_sledovani_objektu</a></div><div class="dTreeNode"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/line.gif" alt=""><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/join.gif" alt=""><img id="iindexmenu_10517370224f4b782dd1cc77" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/folderh.gif" alt=""><a id="sindexmenu_10517370224f4b782dd1cc77" class="nodeUrl" href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/reseni/start" title="reseni" onmouseover="indexmenu_10517370224f4b782dd1cc7.show_feat(&#39;7&#39;);" onmousedown="return indexmenu_checkcontextm(&#39;7&#39;,indexmenu_10517370224f4b782dd1cc7,event);" oncontextmenu="return indexmenu_stopevt(event)" onclick="javascript: indexmenu_10517370224f4b782dd1cc7.s(7);">reseni</a></div><div class="dTreeNode"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/line.gif" alt=""><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/joinbottom.gif" alt=""><img id="iindexmenu_10517370224f4b782dd1cc78" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/page.gif" alt=""><a id="sindexmenu_10517370224f4b782dd1cc78" class="nodeUrl" href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/plagiaty" title="plagiaty" onmouseover="indexmenu_10517370224f4b782dd1cc7.show_feat(&#39;8&#39;);" onmousedown="return indexmenu_checkcontextm(&#39;8&#39;,indexmenu_10517370224f4b782dd1cc7,event);" oncontextmenu="return indexmenu_stopevt(event)" onclick="javascript: indexmenu_10517370224f4b782dd1cc7.s(8);">plagiaty</a></div></div><div class="dTreeNode"><a href="javascript: indexmenu_10517370224f4b782dd1cc7.o(9);"><img id="jindexmenu_10517370224f4b782dd1cc79" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/plusbottom.gif" alt=""></a><img id="iindexmenu_10517370224f4b782dd1cc79" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/folder.gif" alt=""><a id="sindexmenu_10517370224f4b782dd1cc79" href="javascript: indexmenu_10517370224f4b782dd1cc7.o(9); " class="node" onmouseover="indexmenu_10517370224f4b782dd1cc7.show_feat(&#39;9&#39;);" onmousedown="return indexmenu_checkcontextm(&#39;9&#39;,indexmenu_10517370224f4b782dd1cc7,event);" oncontextmenu="return indexmenu_stopevt(event)">internal</a></div><div id="dindexmenu_10517370224f4b782dd1cc79" class="clip" style="display:none;"></div></div></div><div id="zindexmenu_10517370224f4b782dd1cc7" class="indexmenu_rarrow"></div><div id="left_indexmenu_10517370224f4b782dd1cc7" class="indexmenu_larrow" style="display:none;" title="Click to scroll back" onmousedown="javascript:indexmenu_10517370224f4b782dd1cc7.scroll(&#39;r&#39;,1);" onmouseup="javascript:indexmenu_10517370224f4b782dd1cc7.stopscroll();"></div></div>
<hr>

<p>
<a href="http://www.feld.cvut.cz/education/rozvrhy-ng/public/cz/predmety/12/58/p12587204.html" class="urlextern" title="http://www.feld.cvut.cz/education/rozvrhy-ng/public/cz/predmety/12/58/p12587204.html" rel="nofollow">Rozvrh na FEL</a> <br>

<a href="http://www.feld.cvut.cz/education/rozvrhy-ng/public/cz/paralelky/P12/58/par12587204.1.html" class="urlextern" title="http://www.feld.cvut.cz/education/rozvrhy-ng/public/cz/paralelky/P12/58/par12587204.1.html" rel="nofollow">Posluchači MPV</a> <br>

<a href="https://cw.felk.cvut.cz/upload/" class="urlextern" title="https://cw.felk.cvut.cz/upload/" rel="nofollow">Odevzdávací systém</a> <br>

<a href="https://cw.felk.cvut.cz/forum/forum-106.html" class="urlextern" title="https://cw.felk.cvut.cz/forum/forum-106.html" rel="nofollow">Diskusní fórum</a>
</p>

<!-- no cachefile used, caching forbidden -->

    </div>
  </div>

  <div class="clearer">&nbsp;</div>

  
  <div class="stylefoot">

    <div class="meta">
      <div class="user">
              </div>
      <div class="doc">
        /www/pages/data/pages/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start.txt · Last modified: 2012/02/24 12:28 by perdomic      </div>
    </div>

   
    <div class="bar" id="bar__bottom">
      <div class="bar-left" id="bar__bottomleft">
   
	        </div>
      <div class="bar-right" id="bar__bottomright">
                                <form class="button btn_login" method="get" action="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware].html"><div class="no"><input type="hidden" name="do" value="login"><input type="hidden" name="sectok" value="1c0060d9ee5b1ba5eb83ba69c154904a"><input type="submit" value="FEL login" class="button" title="FEL login"></div></form>
<form class="button btn_login" method="get" action="https://cw.felk.cvut.cz/Shibboleth.sso/Logincvut?target="><input type="submit" value="ČVUT login" class="button" title="ČVUT login"></form>
                <a class="nolink" href="http://cw.felk.cvut.cz/doku.php/courses/a4m33mpv/cviceni/2_hledani_korespondenci/start#dokuwiki__top"><input type="button" class="button" value="Back to top" onclick="window.scrollTo(0, 0)" title="Back to top"></a>&nbsp;
      </div>
      <div class="clearer"></div>
    </div>

  </div>

</div>

<div class="footerinc">


     <!--   <a  href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" title="CC Attribution-Noncommercial-Share Alike 3.0 Unported"><img src="http://cw.felk.cvut.cz/lib/images/license/button/cc-by-nc-sa.png" width="80" height="15" alt="" /></a>  -->
  
  <!-- <a  href="http://www.dokuwiki.org/donate" title="Donate"><img src="http://cw.felk.cvut.cz/lib/tpl/cmp/images/button-donate.gif" alt="Donate" width="80" height="15" /></a>

  <a  href="http://www.php.net" title="Powered by PHP"><img src="http://cw.felk.cvut.cz/lib/tpl/cmp/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>

  <a  href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="http://cw.felk.cvut.cz/lib/tpl/cmp/images/button-xhtml.png" width="80" height="15" alt="Valid XHTML 1.0" /></a>

  <a  href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS"><img src="http://cw.felk.cvut.cz/lib/tpl/cmp/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>

  <a  href="http://dokuwiki.org/" title="Driven by DokuWiki"><img src="http://cw.felk.cvut.cz/lib/tpl/cmp/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
--> 
<!-- page made in 0.207 seconds -->

</div>

<div class="no"><img src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/indexer.php" width="1" height="1" alt=""></div>


<div id="gallery__overlay" style="display: none; position: fixed; top: 0px; left: 0px; z-index: 50; width: 100%; height: 100%; "><img id="gallery__loadingImage" src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/loading.gif" style="position: relative; cursor: pointer; "></div><div id="gallery__lightbox" style="display: none; position: absolute; z-index: 60; "><img id="gallery__lightboxImage" style="cursor: pointer; "><img id="gallery__actionImage" style="display: none; position: absolute; top: 15px; left: 15px; z-index: 70; cursor: pointer; " src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/expand.gif"><img id="gallery__closeButton" style="display: inline; position: absolute; right: 10px; top: 10px; z-index: 80; cursor: pointer; " src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/close.gif"><img id="gallery__nextButton" style="display: inline; position: absolute; right: 10px; bottom: 10px; z-index: 80; cursor: pointer; " src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/next.gif"><img id="gallery__prevButton" style="display: inline; position: absolute; left: 10px; bottom: 10px; z-index: 80; cursor: pointer; " src="./a4m33mpv cviceni 2_hledani_korespondenci start [Course Ware]_files/prev.gif"><span id="gallery__lightboxCaption" style="display: none; position: absolute; z-index: 80; "></span></div><div class="indexmenu_rmenu default" id="rindexmenu_10517370224f4b782dd1cc7" style="position: absolute; display: none; "></div></body></html>